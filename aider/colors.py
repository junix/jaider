morandi_colors = [
    "#8C736F",
    "#D4B8B4",
    "#ADAAA5",
    "#B7B7BD",
    "#AAB8AB",
    "#DDD0C8",
    "#A08887",
    "#E2C6C4",
    "#B1ACB3",
    "#53565C",
    "#999EA2",
    "#93939B",
    "#CCD2CC",
    "#DBD2C9",
    "#976666",
    "#C09D9B",
    "#BEBEBE",
    "#7A848D",
    "#A9B7AA",
    "#DBD4C6",
    "#95A098",
    "#C1B0A7",
    "#C3AAA6",
    "#D8C6BA",
    "#C4C1BC",
    "#60656C",
    "#728A7A",
    "#D4C3AA",
    "#A39183",
    "#B09279",
    "#A39797",
    "#4A7056",
    "#597A69",
    "#C4BAB1",
    "#BFADA1",
    "#8E6E57",
    "#88807D",
    "#A39087",
    "#2A483A",
    "#4E6E62",
    "#B2B2A8",
    "#3B4338",
    "#674D41",
    "#845937",
    "#B89886",
    "#DFDCD5",
    "#D2D2D0",
    "#4C5445",
    "#956757",
    "#927157",
    "#492620",
    "#59321D",
    "#8F6849",
    "#C5BDB2",
    "#908982",
    "#1F2C1C",
    "#57372B",
    "#664A3D",
    "#877865",
    "#D1D3C5",
    "#CCB9AA",
    "#EFF0EA",
    "#E1E1DF",
    "#737C75",
    "#AB8C83",
    "#C5AB89",
    "#D2CABF",
    "#F8F8F8",
    "#EBEBE9",
    "#161D15",
    "#8E9BAE",
    "#BFC2CB",
    "#E3D0CC",
    "#BECBD3",
    "#DCDDDF",
    "#DFBFB2",
    "#8592A2",
    "#DCDDD5",
    "#7D6252",
    "#CFC3BC",
    "#EAE0D7",
    "#75809C",
    "#8E9AAB",
    "#DDCFC2",
    "#8D8FA4",
    "#97A5C0",
    "#D6C3B4",
    "#9297AB",
    "#B6BBBE",
    "#D3BBB7",
    "#9D5A16",
    "#DDBCB7",
    "#F4C7B0",
    "#A87153",
    "#CA774B",
    "#996430",
    "#F4BAAF",
    "#F0DED4",
    "#BB6F32",
    "#DDAB77",
    "#BA8249",
    "#CEA48D",
    "#EC8F3F",
    "#D9913C",
    "#EDDFC4",
    "#B86B43",
    "#E7CAA8",
    "#AA7D53",
    "#F8E8D1",
    "#E7D4B5",
    "#D09075",
    "#D3AC73",
    "#F1D09D",
    "#F4D4BE",
    "#CEA77E",
    "#F3C2AF",
    "#F9ECE4",
    "#F4E8C0",
    "#E6C786",
    "#FDE0BE",
    "#B95756",
    "#FD9270",
    "#82ABA3",
    "#72626C",
    "#2A4C65",
    "#CC5F5A",
    "#FAEEC7",
    "#A2AFA6",
    "#8D6A6E",
    "#818C98",
    "#E4745E",
    "#FEC37D",
    "#B6B9AE",
    "#A1706B",
    "#586D80",
    "#F77E66",
    "#FED59E",
    "#CCC5BC",
    "#B87F78",
    "#66828E",
    "#D6DCDB",
    "#82898D",
    "#C0B0A2",
    "#8D6B61",
    "#E3E7EA",
    "#C6CCC0",
    "#E1AA8D",
    "#F2EEED",
    "#A1B0AD",
    "#C39289",
    "#D6E1D7",
    "#C1CCC7",
    "#E4B69E",
    "#A98978",
    "#BFD1C4",
    "#E0DFE4",
    "#B3CAD8",
    "#DBB89C",
    "#F2DBD5",
    "#BDC4CC",
    "#E6DEDC",
    "#FFFFFF",
    "#F4EBE4",
    "#EBD8C9",
    "#EED1CC",
    "#F8D4BC",
    "#EBC2C0",
    "#EBE2E5",
    "#C7A9A1",
    "#9DA8AF",
    "#B2BA81",
    "#8F9650",
    "#798223",
    "#646D20",
    "#928D3C",
    "#666218",
    "#5B5611",
    "#403D10",
    "#3B420E",
    "#4F5518",
    "#ADB5AB",
    "#8A9585",
    "#889F8B",
    "#7C9788",
    "#678F74",
    "#478058",
    "#0F2C18",
    "#17341E",
    "#2B4832",
    "#37613C",
    "#EEF1EA",
    "#C0C182",
    "#CECB88",
    "#D9DFC5",
    "#B5AF5A",
    "#BFBC9D",
    "#CDDAA5",
    "#A09952",
    "#C1BFAC",
    "#D6D9B9",
    "#ECE3E8",
    "#EEDAC0",
    "#EFD3AC",
    "#D7CDD5",
    "#E4C7C3",
    "#F3F4D5",
    "#627676",
    "#C9B4C7",
    "#CFA79D",
    "#DEE1CB",
    "#93A3A0",
    "#A392A2",
    "#DEA592",
    "#CFD1C4",
    "#C9D3D5",
    "#8B7F8B",
    "#F3D2C3",
    "#BBBEB5",
    "#DFF7E6",
    "#A8B2AA",
    "#E8D8D7",
    "#CBA29E",
    "#D0DCDD",
    "#DAC1C2",
    "#E2CFCB",
    "#E6F1ED",
    "#D4E3DD",
    "#EFD5DC",
    "#F2D5CF",
    "#CADBD4",
]

colors_jun = [
    "#a3878a",
    "#f8bd7f",
    "#a59ec9",
    "#bfd0ba",
    "#dcd4c5",
    "#778b98",
    "#767265",
    "#9a8f97",
    "#c3baba",
    "#39886f",
    "#3e465c",
    "#44444d",
    "#4d585d",
    "#51485e",
    "#586765",
    "#5f5366",
    "#5f9ea0",
    "#696969",
    "#708090",
    "#708090",
    "#72807f",
    "#728f8e",
    "#76888f",
    "#7a767f",
    "#7d9094",
    "#8b8589",
    "#8ca0ab",
    "#8d6c75",
    "#9195b6",
    "#93b3d1",
    "#9d7982",
    "#a9647e",
    "#a9a9a9",
    "#a9a9a9",
    "#afbcc1",
    "#bc8f8f",
    "#c08081",
    "#c2d0d0",
    "#c4c3d0",
    "#c6c09c",
    "#c8b7c9",
    "#d0ddeb",
    "#d2d7e7",
    "#d36e70",
    "#d3d3d3",
    "#d7efe5",
    "#d9ead3",
    "#e3bcac",
    "#e3e7e7",
    "#e79796",
    "#e9967a",
    "#f4a6a6",
    "#f4cfc7",
    "#fdc9c7",
    "#fdfdcc",
    "#ffbe98",
    "#ffc98b",
    "#fff5ec",
]

colors_jun_dark = [
    "#00755e",
    "#bfb6e2",
    "#91b38e",
    "#706677",
    "#dad0e0",
    "#cabed8",
    "#0982a5",
    "#485663",
    "#becbce",
    "#002516",
    "#b5e48c",
    "#b3c5c7",
    "#7d929b",
    "#ffb384",
    "#bfe4ea",
    "#002147",
    "#53455d",
    "#584e5f",
    "#003153",
    "#f7f4ca",
    "#01554f",
    "#041440",
    "#e2fcff",
    "#bfb2ba",
    "#c4b2bc",
    "#194142",
    "#724a81",
    "#cab7d4",
    "#1c2841",
    "#83a7ae",
    "#d8d4f2",
    "#1d2951",
    "#364355",
    "#305d7e",
    "#83a7ae",
    "#1f302b",
    "#204769",
    "#294958",
    "#2a3c4f",
    "#322d33",
    "#343b36",
    "#345612",
    "#364e4a",
    "#382c3e",
    "#383842",
    "#394543",
    "#397878",
    "#3a292c",
    "#3b3b66",
    "#413956",
    "#442646",
    "#44444d",
    "#4b3621",
    "#4b4b4b",
    "#4b5652",
    "#51485e",
    "#54504a",
    "#54504a",
    "#54504f",
    "#555d50",
    "#5e5959",
    "#606060",
    "#655a8b",
    "#6b586b",
    "#6d6d65",
    "#783958",
    "#7e4a60",
    "#817a6e",
    "#83698d",
    "#89667c",
    "#897969",
    "#897969",
    "#9189a2",
    "#9698bf",
]


# Generate a color palette plot with color codes
def get_optimal_font_color(hex_color):
    """Determine if white or black font color is better for readability on a given background color."""
    # Convert hex to RGB
    hex_color = hex_color.lstrip("#")
    rgb = tuple(int(hex_color[i : i + 2], 16) for i in (0, 2, 4))

    # Calculate luminance (relative brightness)
    luminance = (0.299 * rgb[0] + 0.587 * rgb[1] + 0.114 * rgb[2]) / 255

    # Return black if luminance is high, white if low
    return "black" if luminance > 0.5 else "white"


def calculate_luminance(hex_color):
    """Calculate the luminance of a given hex color."""
    # Convert hex to RGB
    hex_color = hex_color.lstrip("#")
    rgb = tuple(int(hex_color[i : i + 2], 16) for i in (0, 2, 4))

    # Calculate luminance (relative brightness)
    luminance = (0.299 * rgb[0] + 0.587 * rgb[1] + 0.114 * rgb[2]) / 255

    return luminance


def contrast_of(hex_color1, hex_color2):
    """Compare two colors and determine if they contrast well."""
    luminance1 = calculate_luminance(hex_color1)
    luminance2 = calculate_luminance(hex_color2)

    return abs(luminance1 - luminance2)


def generate_gradient_colors(start_color):
    import matplotlib.colors as mcolors

    # 将起始颜色转换为HLS颜色空间
    h, l, s = mcolors.rgb_to_hsv(mcolors.hex2color(start_color))

    if l < 0.1:
        right_l = 1
        left_l = min(0.90, l + 0.5, 0.8)
    elif l < 0.4:
        right_l = 1
        left_l = min(0.9, l + 0.3, 0.8)
    elif l > 0.8:
        left_l = max(0.1, l - 0.3)
        right_l = max(0.1, l - 0.5)
    else:
        left_l = max(0.1, l - 0.4)
        right_l = min(0.9, l + 0.4)

    # from icecream import ic
    # ic(left_l, l, right_l)
    left_color = mcolors.hsv_to_rgb((h, left_l, s))
    right_color = mcolors.hsv_to_rgb((h, right_l, s))

    return mcolors.rgb2hex(left_color), start_color, mcolors.rgb2hex(right_color)


def most_contrasting_color(already_used_colors, available_colors):
    best_contrast = 0
    best_color = None
    while already_used_colors:
        current = already_used_colors.pop()
        new_available_colors = []
        for color in available_colors:
            if color in already_used_colors:
                continue
            contrast = contrast_of(current, color)
            if contrast > best_contrast:
                best_contrast = contrast
                best_color = color
            if contrast > 0.5:
                new_available_colors.append(color)
        available_colors = new_available_colors

    return best_color or "black"


def display_color_palette(colors):
    import matplotlib.pyplot as plt

    fig, ax = plt.subplots(figsize=(15, 10))

    # Plot the colors in a grid with their hex codes
    for i, color in enumerate(colors):
        row = i // 8
        col = i % 8
        ax.add_patch(plt.Rectangle((col, row), 1, 1, color=color))
        ax.text(
            col + 0.5,
            row + 0.5,
            color,
            ha="center",
            va="center",
            fontsize=8,
            color="white" if i % 2 == 0 else "black",
        )

    # Set the limits and remove axes
    ax.set_xlim(0, 8)
    ax.set_ylim(0, (len(colors_jun_dark) // 8) + 1)
    ax.axis("off")

    # Display the plot
    plt.show()
